---
import { format } from 'date-fns';
import { nl as locale } from 'date-fns/locale/nl';
import type { ArticlePreviewFragment } from '../lib/sanity';
import { randomBorderRadius } from '../lib/util';
import PortableText from './portable-text.astro';
import SanityImage from './sanity-image.astro';

export type Props = ArticlePreviewFragment;

const { mainImage, title, excerpt, publishedAt } = Astro.props;
---

<div class="[ article-preview ]">
  <div class="article-preview__image" style={`--radius: ${randomBorderRadius()};`}>
    <SanityImage {...mainImage} width={700} aspectRatioOverride={16 / 9} caption="" />
  </div>
  <div class="[ article-preview__text ] [ stack ]">
    <div class="article-preview__heading">{title}</div>
    <div class="article-preview__excerpt">
      <PortableText blocks={excerpt} />
    </div>
    <div class="article-preview__published-at">
      {format(new Date(publishedAt), 'd MMMM yyyy', { locale })}
    </div>
  </div>
</div>

<style>
  .article-preview {
    display: grid;
    grid-template-columns: min(33vw, 350px) auto;
    align-items: center;
    gap: 1rem;

    @media (max-width: 600px) {
      grid-template-columns: 1fr;
      gap: 0.5rem;
      margin-block-end: var(--font-size-xxl);
    }
  }

  .article-preview__image {
    border-radius: var(--radius);
    overflow: hidden;
  }

  .article-preview__text.article-preview__text {
    gap: var(--size-1);
    max-width: var(--size-content-2);
  }

  .article-preview__heading {
    font-weight: var(--font-weight-4);
  }

  .article-preview__excerpt {
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    display: -webkit-box;
    overflow: hidden;
    color: var(--gray-6);
  }

  .article-preview__published-at {
    color: var(--gray-6);
    font-size: var(--font-size-sm);
  }
</style>
